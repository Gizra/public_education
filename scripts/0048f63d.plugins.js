var leafletDirective=angular.module("leaflet-directive",[]);leafletDirective.directive("leaflet",["$http","$log","$parse","$rootScope",function(a,b,c,d){var e={maxZoom:14,minZoom:1,doubleClickZoom:!0,scrollWheelZoom:!0,zoomControl:!0,attributionControl:!0,zoomsliderControl:!1,controlLayersPosition:"topright",tileLayer:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",tileLayerOptions:{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},icon:{url:"http://cdn.leafletjs.com/leaflet-0.6.4/images/marker-icon.png",retinaUrl:"http://cdn.leafletjs.com/leaflet-0.6.4/images/marker-icon@2x.png",size:[25,41],anchor:[12,40],popup:[0,-40],shadow:{url:"http://cdn.leafletjs.com/leaflet-0.6.4/images/marker-shadow.png",retinaUrl:"http://cdn.leafletjs.com/leaflet-0.6.4/images/marker-shadow.png",size:[41,41],anchor:[12,40]}},path:{weight:10,opacity:1,color:"#0000ff"},center:{lat:0,lng:0,zoom:1}},f=L.Icon.extend({options:{iconUrl:e.icon.url,iconRetinaUrl:e.icon.retinaUrl,iconSize:e.icon.size,iconAnchor:e.icon.anchor,popupAnchor:e.icon.popup,shadowUrl:e.icon.shadow.url,shadowRetinaUrl:e.icon.shadow.retinaUrl,shadowSize:e.icon.shadow.size,shadowAnchor:e.icon.shadow.anchor}}),g={AwesomeMarkersPlugin:{isLoaded:function(){return void 0!==L.AwesomeMarkers?void 0!==L.AwesomeMarkers.Icon:!1},is:function(a){return this.isLoaded()?a instanceof L.AwesomeMarkers.Icon:!1},equal:function(a,c){return this.isLoaded?this.is(a)&&this.is(c)?a.options.icon===c.options.icon&&a.options.iconColor===c.options.iconColor&&a.options.color===c.options.color&&a.options.iconSize[0]===c.options.iconSize[0]&&a.options.iconSize[1]===c.options.iconSize[1]&&a.options.iconAnchor[0]===c.options.iconAnchor[0]&&a.options.iconAnchor[1]===c.options.iconAnchor[1]&&a.options.popupAnchor[0]===c.options.popupAnchor[0]&&a.options.popupAnchor[1]===c.options.popupAnchor[1]&&a.options.shadowAnchor[0]===c.options.shadowAnchor[0]&&a.options.shadowAnchor[1]===c.options.shadowAnchor[1]&&a.options.shadowSize[0]===c.options.shadowSize[0]&&a.options.shadowSize[1]===c.options.shadowSize[1]:!1:(b.error("[AngularJS - Leaflet] AwesomeMarkers Plugin not Loaded"),!1)}},MarkerClusterPlugin:{isLoaded:function(){return void 0!==L.MarkerClusterGroup},is:function(a){return this.isLoaded()?a instanceof L.MarkerClusterGroup:!1}},GoogleLayerPlugin:{isLoaded:function(){return void 0!==L.Google},is:function(a){return this.isLoaded()?a instanceof L.Google:!1}},BingLayerPlugin:{isLoaded:function(){return void 0!==L.BingLayer},is:function(a){return this.isLoaded()?a instanceof L.BingLayer:!1}},Leaflet:{DivIcon:{is:function(a){return a instanceof L.DivIcon},equal:function(a,b){return this.is(a)&&this.is(b)?a.options.html===b.options.html&&a.options.iconSize[0]===b.options.iconSize[0]&&a.options.iconSize[1]===b.options.iconSize[1]&&a.options.iconAnchor[0]===b.options.iconAnchor[0]&&a.options.iconAnchor[1]===b.options.iconAnchor[1]:!1}},Icon:{is:function(a){return a instanceof L.Icon},equal:function(a,b){return this.is(a)&&this.is(b)?a.options.iconUrl===b.options.iconUrl&&a.options.iconRetinaUrl===b.options.iconRetinaUrl&&a.options.iconSize[0]===b.options.iconSize[0]&&a.options.iconSize[1]===b.options.iconSize[1]&&a.options.iconAnchor[0]===b.options.iconAnchor[0]&&a.options.iconAnchor[1]===b.options.iconAnchor[1]&&a.options.shadowUrl===b.options.shadowUrl&&a.options.shadowRetinaUrl===b.options.shadowRetinaUrl&&a.options.shadowSize[0]===b.options.shadowSize[0]&&a.options.shadowSize[1]===b.options.shadowSize[1]&&a.options.shadowAnchor[0]===b.options.shadowAnchor[0]&&a.options.shadowAnchor[1]===b.options.shadowAnchor[1]&&a.options.popupAnchor[0]===b.options.popupAnchor[0]&&a.options.popupAnchor[1]===b.options.popupAnchor[1]:!1}}}},h='Add testing="testing" to <leaflet> tag to inspect this object';return{restrict:"E",replace:!0,transclude:!0,scope:{center:"=center",maxBounds:"=maxbounds",bounds:"=bounds",marker:"=marker",markers:"=markers",legend:"=legend",geojson:"=geojson",defaults:"=defaults",paths:"=paths",tiles:"=tiles",events:"=events",layers:"=layers",customControls:"=customControls",leafletMap:"=leafletmap"},template:'<div class="angular-leaflet-map"></div>',link:function(a,i,j){function k(){var b=a.$root.$$phase;return!("$apply"===b||"$digest"===b)}function l(b){k()?a.$apply(b):a.$eval(b)}function m(){function a(a){return function(b){var c="leafletDirectiveMap."+a;l(function(){d.$broadcast(c,{leafletEvent:b})})}}for(var b=["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","focus","blur","preclick","load","unload","viewreset","movestart","move","moveend","dragstart","drag","dragend","zoomstart","zoomend","zoomlevelschange","resize","autopanstart","layeradd","layerremove","baselayerchange","overlayadd","overlayremove","locationfound","locationerror","popupopen","popupclose"],c=0;c<b.length;c++){var e=b[c];N.on(e,a(e),{eventName:e})}}function n(){if("object"!=typeof a.events)return!1;for(var b in a.events)N.on(b,a.events[b])}function o(){if(void 0===a.layers||null===a.layers)w();else{if(void 0===a.layers.baselayers||null===a.layers.baselayers||"object"!=typeof a.layers.baselayers)return b.error("[AngularJS - Leaflet] At least one baselayer has to be defined"),a.leaflet.layers=j.testing?O:h,void 0;if(Object.keys(a.layers.baselayers).length<=0)return b.error("[AngularJS - Leaflet] At least one baselayer has to be defined"),a.leaflet.layers=j.testing?O:h,void 0;O={},O.baselayers={},O.controls={},O.controls.layers=new L.control.layers,a.defaults&&a.defaults.controlLayersPosition&&O.controls.layers.setPosition(a.defaults.controlLayersPosition),O.controls.layers.addTo(N);var c=!1;for(var d in a.layers.baselayers){var e=p(a.layers.baselayers[d]);null!==e&&(O.baselayers[d]=e,a.layers.baselayers[d].top===!0&&(N.addLayer(O.baselayers[d]),c=!0),O.controls.layers.addBaseLayer(O.baselayers[d],a.layers.baselayers[d].name))}!c&&Object.keys(O.baselayers).length>0&&N.addLayer(O.baselayers[Object.keys(a.layers.baselayers)[0]]),O.overlays={};for(d in a.layers.overlays){var f=p(a.layers.overlays[d]);null!==f&&(O.overlays[d]=f,a.layers.overlays[d].visible===!0&&N.addLayer(O.overlays[d]),O.controls.layers.addOverlay(O.overlays[d],a.layers.overlays[d].name))}a.$watch("layers.baselayers",function(c){var d=!1;for(var e in O.baselayers)void 0===c[e]&&(O.controls.layers.removeLayer(O.baselayers[e]),N.hasLayer(O.baselayers[e])&&N.removeLayer(O.baselayers[e]),delete O.baselayers[e],d=!0);for(var f in c)if(void 0===O.baselayers[f]){var g=p(c[f]);null!==g&&(O.baselayers[f]=g,c[f].top===!0&&N.addLayer(O.baselayers[f]),O.controls.layers.addBaseLayer(O.baselayers[f],c[f].name))}if(Object.keys(O.baselayers).length<=0)b.error("[AngularJS - Leaflet] At least one baselayer has to be defined");else{var h=!1;for(var i in O.baselayers)if(N.hasLayer(O.baselayers[i])){h=!0;break}h||N.addLayer(O.baselayers[Object.keys(a.layers.baselayers)[0]])}},!0),a.$watch("layers.overlays",function(a){for(var b in O.overlays)void 0===a[b]&&(O.controls.layers.removeLayer(O.overlays[b]),N.hasLayer(O.overlays[b])&&N.removeLayer(O.overlays[b]),delete O.overlays[b]);for(var c in a)if(void 0===O.overlays[c]){var d=p(a[c]);null!==d&&(O.overlays[c]=d,O.controls.layers.addOverlay(O.overlays[c],a[c].name),a[c].visible===!0&&N.addLayer(O.overlays[c]))}},!0)}a.leaflet.layers=j.testing?O:h}function p(a){if(void 0===a.type||null===a.type||"string"!=typeof a.type)return b.error("[AngularJS - Leaflet] A base layer must have a type"),null;if("xyz"!==a.type&&"wms"!==a.type&&"group"!==a.type&&"markercluster"!==a.type&&"google"!==a.type&&"bing"!==a.type)return b.error('[AngularJS - Leaflet] A layer must have a valid type: "xyz, wms, group, google"'),null;if(!("xyz"!==a.type&&"wms"!==a.type||void 0!==a.url&&null!==a.url&&"string"==typeof a.url))return b.error("[AngularJS - Leaflet] A base layer must have an url"),null;if(void 0===a.name||null===a.name||"string"!=typeof a.name)return b.error("[AngularJS - Leaflet] A base layer must have a name"),null;(void 0===a.layerParams||null===a.layerParams||"object"!=typeof a.layerParams)&&(a.layerParams={}),(void 0===a.layerOptions||null===a.layerOptions||"object"!=typeof a.layerOptions)&&(a.layerOptions={});var c=null;for(var d in a.layerParams)a.layerOptions[d]=a.layerParams[d];switch(a.type){case"xyz":c=q(a.url,a.layerOptions);break;case"wms":c=r(a.url,a.layerOptions);break;case"group":c=s();break;case"markercluster":c=t(a.layerOptions);break;case"google":c=u(a.layerType,a.layerOptions);break;case"bing":c=v(a.bingKey,a.layerOptions);break;default:c=null}return c}function q(a,b){var c=L.tileLayer(a,b);return c}function r(a,b){var c=L.tileLayer.wms(a,b);return c}function s(){var a=L.layerGroup();return a}function t(a){if(g.MarkerClusterPlugin.isLoaded()){var b=new L.MarkerClusterGroup(a);return b}return null}function u(a,b){if(a=a||"SATELLITE",g.GoogleLayerPlugin.isLoaded()){var c=new L.Google(a,b);return c}return null}function v(a,b){if(g.BingLayerPlugin.isLoaded()){var c=new L.BingLayer(a,b);return c}return null}function w(){var b,c;if(a.leaflet.tileLayer=j.defaults&&a.defaults&&a.defaults.tileLayer?a.defaults.tileLayer:e.tileLayer,a.defaults&&a.defaults.tileLayerOptions)for(c in a.defaults.tileLayerOptions)e.tileLayerOptions[c]=a.defaults.tileLayerOptions[c];if(j.tiles){if(a.tiles&&a.tiles.url&&(a.leaflet.tileLayer=a.tiles.url),a.tiles&&a.tiles.options)for(c in a.tiles.options)e.tileLayerOptions[c]=a.tiles.options[c];a.$watch("tiles.url",function(a){a&&b.setUrl(a)})}b=L.tileLayer(a.leaflet.tileLayer,e.tileLayerOptions),b.addTo(N),a.leaflet.tileLayerObj=j.testing?b:h}function x(){if(a.legend)if(a.legend.colors&&a.legend.labels&&a.legend.colors.length===a.legend.labels.length){var c=a.legendClass?a.legendClass:"legend",d=a.legend.position||"bottomright",e=L.control({position:d});e.onAdd=function(){for(var b=L.DomUtil.create("div",c),d=0;d<a.legend.colors.length;d++)b.innerHTML+='<div><i style="background:'+a.legend.colors[d]+'"></i>'+a.legend.labels[d]+"</div>";return b},e.addTo(N)}else b.warn("[AngularJS - Leaflet] legend.colors and legend.labels must be set.")}function y(){a.maxBounds&&a.maxBounds.southWest&&a.maxBounds.southWest.lat&&a.maxBounds.southWest.lng&&a.maxBounds.northEast&&a.maxBounds.northEast.lat&&a.maxBounds.northEast.lng&&(N.setMaxBounds(new L.LatLngBounds(new L.LatLng(a.maxBounds.southWest.lat,a.maxBounds.southWest.lng),new L.LatLng(a.maxBounds.northEast.lat,a.maxBounds.northEast.lng))),a.$watch("maxBounds",function(a){a.southWest&&a.northEast&&a.southWest.lat&&a.southWest.lng&&a.northEast.lat&&a.northEast.lng&&N.setMaxBounds(new L.LatLngBounds(new L.LatLng(a.southWest.lat,a.southWest.lng),new L.LatLng(a.northEast.lat,a.northEast.lng)))}))}function z(a){if(a){var b=a.southWest,c=a.northEast;if(b&&c&&b.lat&&b.lng&&c.lat&&c.lng){var d=new L.LatLng(b.lat,b.lng),e=new L.LatLng(c.lat,c.lng);N.fitBounds(new L.LatLngBounds(d,e))}}}function A(){a.bounds&&a.$watch("bounds",function(a){z(a)})}function B(){if(!a.center)return b.warn("[AngularJS - Leaflet] 'center' is undefined in the current scope, did you forget to initialize it?"),N.setView([e.center.lat,e.center.lng],e.center.zoom),void 0;void 0!==a.center.lat&&null!==a.center.lat&&"number"==typeof a.center.lat&&void 0!==a.center.lng&&null!==a.center.lng&&"number"==typeof a.center.lng&&void 0!==a.center.zoom&&null!==a.center.zoom&&"number"==typeof a.center.zoom?N.setView([a.center.lat,a.center.lng],a.center.zoom):j.center.autoDiscover===!0?N.locate({setView:!0,maxZoom:a.leaflet.maxZoom}):(b.warn("[AngularJS - Leaflet] 'center' is incorrect"),N.setView([e.center.lat,e.center.lng],e.center.zoom));var d={lat:c("center.lat"),lng:c("center.lng"),zoom:c("center.zoom")};a.$watch("center",function(c,d){return c?(d&&(void 0!==c.lat&&null!==c.lat&&"number"==typeof c.lat&&void 0!==c.lng&&null!==c.lng&&"number"==typeof c.lng&&void 0!==c.zoom&&null!==c.zoom&&"number"==typeof c.zoom?void 0!==d.lat&&null!==d.lat&&"number"==typeof d.lat&&void 0!==d.lng&&null!==d.lng&&"number"==typeof d.lng&&void 0!==d.zoom&&null!==d.zoom&&"number"==typeof d.zoom?(c.lat!==d.lat||c.lng!==d.lng||c.zoom!==d.zoom)&&N.setView([c.lat,c.lng],c.zoom):N.setView([c.lat,c.lng],c.zoom):c.autoDiscover===!0&&d.autoDiscover!==!0?N.locate({setView:!0,maxZoom:a.leaflet.maxZoom}):(void 0===c.autoDiscover||null===c.autoDiscover)&&(b.warn("[AngularJS - Leaflet] 'center' is incorrect"),N.setView([e.center.lat,e.center.lng],e.center.zoom))),void 0):(b.warn("[AngularJS - Leaflet] 'center' have been removed?"),N.setView([e.center.lat,e.center.lng],e.center.zoom),void 0)},!0),N.on("moveend",function(){l(function(a){d&&(d.lat.assign(a,N.getCenter().lat),d.lng.assign(a,N.getCenter().lng),d.zoom.assign(a,N.getZoom()))})})}function C(){a.$watch("geojson",function(b){if(b&&(a.leaflet.geojson&&N.removeLayer(a.leaflet.geojson),b.hasOwnProperty("data"))){var c=a.geojson.resetStyleOnMouseout;a.leaflet.geojson=L.geoJson(a.geojson.data,{style:a.geojson.style,onEachFeature:function(e,f){f.on({mouseover:function(a){l(function(){b.selected=e,d.$broadcast("leafletDirectiveMap.geojsonMouseover",a)})},mouseout:function(e){c&&a.leaflet.geojson.resetStyle(e.target),l(function(){b.selected=void 0,d.$broadcast("leafletDirectiveMap.geojsonMouseout",e)})},click:function(a){l(function(){d.$broadcast("leafletDirectiveMap.geojsonClick",b.selected,a)})}})}}).addTo(N)}})}function D(){var b;a.marker&&(b=F("marker",a.marker,N),a.leaflet.marker=j.testing?b:h,b.on("click",function(){l(function(){d.$broadcast("leafletDirectiveMainMarkerClick")})}))}function E(){var b={};if(a.markers){for(var c in a.markers){var d=F("markers."+c,a.markers[c],N);null!==d&&(b[c]=d)}a.$watch("markers",function(c){for(var d in b)if(void 0===c[d]){if(b[d].closePopup(),void 0!==O&&null!==O&&void 0!==O.overlays)for(var e in O.overlays)O.overlays[e]instanceof L.LayerGroup&&O.overlays[e].hasLayer(b[d])&&O.overlays[e].removeLayer(b[d]);N.removeLayer(b[d]),delete b[d]}for(var f in c)if(void 0===b[f]){var g=F("markers."+f,a.markers[f],N);null!==g&&(b[f]=g)}},!0),a.leaflet.markers=j.testing?b:h}}function F(c,e,h){function i(a){return function(b){var f="leafletDirectiveMarker."+a,g=c.replace("markers.","");"click"===a?l(function(){d.$broadcast("leafletDirectiveMarkersClick",g)}):"dragend"===a&&(l(function(){e.lat=j.getLatLng().lat,e.lng=j.getLatLng().lng}),e.message&&e.focus===!0&&j.openPopup()),l(function(){d.$broadcast(f,{markerName:g,leafletEvent:b})})}}var j=G(e);if(void 0===e.layer)h.addLayer(j),e.focus===!0&&j.openPopup();else{if("string"!=typeof e.layer)return b.error("[AngularJS - Leaflet] A layername must be a string"),null;if(null===O)return b.error("[AngularJS - Leaflet] You must add layers to the directive if used in a marker"),null;if(null===O.overlays||void 0===O.overlays)return b.error("[AngularJS - Leaflet] You must add layers overlays to the directive if used in a marker"),null;if(void 0===O.overlays[e.layer]&&null===O.overlays[e.layer])return b.error("[AngularJS - Leaflet] You must use a name of an existing layer"),null;var k=O.overlays[e.layer];if(!(k instanceof L.LayerGroup))return b.error('[AngularJS - Leaflet] A marker can only be added to a layer of type "group"'),null;k.addLayer(j),h.hasLayer(j)&&e.focus===!0&&j.openPopup()}for(var m=["click","dblclick","mousedown","mouseover","mouseout","contextmenu","dragstart","drag","dragend","move","remove","popupopen","popupclose"],n=0;n<m.length;n++){var o=m[n];j.on(o,i(o),{eventName:o,scope_watch_name:c})}var p=a.$watch(c,function(a,c){if(!a){if(j.closePopup(),void 0!==O&&null!==O&&void 0!==O.overlays)for(var d in O.overlays)O.overlays[d]instanceof L.LayerGroup&&O.overlays[d].hasLayer(j)&&O.overlays[d].removeLayer(j);return h.removeLayer(j),p(),void 0}if(c){if(void 0===a.layer||null===a.layer||"string"!=typeof a.layer)void 0!==c.layer&&null!==c.layer&&"string"==typeof c.layer&&(void 0!==O.overlays[c.layer]&&O.overlays[c.layer].hasLayer(j)&&(O.overlays[c.layer].removeLayer(j),j.closePopup()),h.hasLayer(j)||h.addLayer(j));else if(void 0===c.layer||null===c.layer||c.layer!==a.layer)if("string"==typeof c.layer&&void 0!==O.overlays[c.layer]&&O.overlays[c.layer].hasLayer(j)&&O.overlays[c.layer].removeLayer(j),j.closePopup(),h.hasLayer(j)&&h.removeLayer(j),void 0!==O.overlays[a.layer]){var e=O.overlays[a.layer];e instanceof L.LayerGroup?(e.addLayer(j),h.hasLayer(j)&&a.focus===!0&&j.openPopup()):b.error('[AngularJS - Leaflet] A marker can only be added to a layer of type "group"')}else b.error("[AngularJS - Leaflet] You must use a name of an existing layer");if(void 0===a.draggable||null===a.draggable||a.draggable!==!0?void 0!==c.draggable&&null!==c.draggable&&c.draggable===!0&&j.dragging.disable():(void 0===c.draggable||null===c.draggable||c.draggable!==!0)&&j.dragging.enable(),void 0===a.icon||null===a.icon||"object"!=typeof a.icon)void 0!==c.icon&&null!==c.icon&&"object"==typeof c.icon&&(j.setIcon(new f),j.closePopup(),j.unbindPopup(),void 0!==a.message&&null!==a.message&&"string"==typeof a.message&&""!==a.message&&j.bindPopup(a.message));else if(void 0===c.icon||null===c.icon||"object"!=typeof c.icon){var i=j.dragging.enabled();g.AwesomeMarkersPlugin.is(a.icon)?j.setIcon(a.icon):g.Leaflet.DivIcon.is(a.icon)||g.Leaflet.Icon.is(a.icon)?j.setIcon(a.icon):j.setIcon(new f(a.icon)),i&&j.dragging.enable(),j.closePopup(),j.unbindPopup(),void 0!==a.message&&null!==a.message&&"string"==typeof a.message&&""!==a.message&&j.bindPopup(a.message)}else if(g.AwesomeMarkersPlugin.is(a.icon)){if(!g.AwesomeMarkersPlugin.equal(a.icon,c.icon)){var k=j.dragging.enabled();j.setIcon(a.icon),k&&j.dragging.enable(),j.closePopup(),j.unbindPopup(),void 0!==a.message&&null!==a.message&&"string"==typeof a.message&&""!==a.message&&j.bindPopup(a.message)}}else if(g.Leaflet.DivIcon.is(a.icon)){if(!g.Leaflet.DivIcon.equal(a.icon,c.icon)){var l=j.dragging.enabled();j.setIcon(a.icon),l&&j.dragging.enable(),j.closePopup(),j.unbindPopup(),void 0!==a.message&&null!==a.message&&"string"==typeof a.message&&""!==a.message&&j.bindPopup(a.message)}}else if(g.Leaflet.Icon.is(a.icon)){if(!g.Leaflet.Icon.equal(a.icon,c.icon)){var m=j.dragging.enabled();j.setIcon(a.icon),m&&j.dragging.enable(),j.closePopup(),j.unbindPopup(),void 0!==a.message&&null!==a.message&&"string"==typeof a.message&&""!==a.message&&j.bindPopup(a.message)}}else if(JSON.stringify(a.icon)!==JSON.stringify(c.icon)){var n=j.dragging.enabled();j.setIcon(new f(a.icon)),n&&j.dragging.enable(),j.closePopup(),j.unbindPopup(),void 0!==a.message&&null!==a.message&&"string"==typeof a.message&&""!==a.message&&j.bindPopup(a.message)}if(void 0===a.message||null===a.message||"string"!=typeof a.message||""===a.message?void 0!==c.message&&null!==c.message&&"string"==typeof c.message&&""!==c.message&&(j.closePopup(),j.unbindPopup()):void 0===c.message||null===c.message||"string"!=typeof c.message||""===c.message?(j.bindPopup(a.message),a.focus===!0&&j.openPopup()):a.message!==c.message&&j.setPopupContent(a.message),void 0===a.focus||null===a.focus||a.focus!==!0?void 0!==c.focus&&null!==c.focus&&c.focus===!0&&j.closePopup():(void 0===c.focus||null===c.focus||c.focus!==!0)&&j.openPopup(),void 0===a.lat||null===a.lat||isNaN(a.lat)||"number"!=typeof a.lat||void 0===a.lng||null===a.lng||isNaN(a.lng)||"number"!=typeof a.lng){if(b.warn("There are problems with lat-lng data, please verify your marker model"),null!==O&&void 0!==O.overlays&&null!==O.overlays)for(var o in O.overlays)(O.overlays[o]instanceof L.LayerGroup||g.MarkerClusterPlugin.is(O.overlays[o]))&&O.overlays[o].hasLayer(j)&&O.overlays[o].removeLayer(j);h.removeLayer(j)}else{var q=j.getLatLng();if(q.lat!==a.lat||q.lng!==a.lng){var r=!1;void 0!==a.layer&&null!==a.layer&&"string"==typeof a.layer&&g.MarkerClusterPlugin.is(O.overlays[a.layer])&&(O.overlays[a.layer].removeLayer(j),r=!0),j.setLatLng([a.lat,a.lng]),r&&O.overlays[a.layer].addLayer(j)}}}},!0);return j}function G(a){var b=null;b=a.icon?a.icon:new f;var c={icon:b,draggable:a.draggable?!0:!1};a.title&&(c.title=a.title);var d=new L.marker(a,c);return a.message&&d.bindPopup(a.message),d}function H(){var c={};if(a.leaflet.paths=j.testing?c:h,a.paths){b.warn("[AngularJS - Leaflet] Creating polylines and adding them to the map will break the directive's scope's inspection in AngularJS Batarang");for(var d in a.paths)c[d]=I(d,a.paths[d],N);a.$watch("paths",function(a){for(var b in a)void 0===c[b]&&(c[b]=I(b,a[b],N));for(var d in c)void 0===a[d]&&delete c[d]},!0)}}function I(b,c,d){var f=new L.Polyline([],{weight:e.path.weight,color:e.path.color,opacity:e.path.opacity});if(void 0!==c.latlngs){var g=J(c.latlngs);f.setLatLngs(g)}void 0!==c.weight&&f.setStyle({weight:c.weight}),void 0!==c.color&&f.setStyle({color:c.color}),void 0!==c.opacity&&f.setStyle({opacity:c.opacity}),d.addLayer(f);var h=a.$watch("paths."+b,function(a,b){if(!a)return d.removeLayer(f),h(),void 0;if(b){if(void 0!==a.latlngs&&a.latlngs!==b.latlngs){var c=J(a.latlngs);f.setLatLngs(c)}void 0!==a.weight&&a.weight!==b.weight&&f.setStyle({weight:a.weight}),void 0!==a.color&&a.color!==b.color&&f.setStyle({color:a.color}),void 0!==a.opacity&&a.opacity!==b.opacity&&f.setStyle({opacity:a.opacity})}},!0);return f}function J(a){var b=a.filter(function(a){return!!a.lat&&!!a.lng}).map(function(a){return new L.LatLng(a.lat,a.lng)});return b}function K(){N.zoomControl&&a.defaults&&a.defaults.zoomControlPosition&&N.zoomControl.setPosition(a.defaults.zoomControlPosition),N.zoomControl&&a.defaults&&a.defaults.zoomControl===!1&&N.zoomControl.removeFrom(N),N.zoomsliderControl&&a.defaults&&!a.defaults.zoomsliderControl&&N.zoomsliderControl.removeFrom(N)}function M(){if(a.customControls)for(var b=0,c=a.customControls.length;c>b;b++)N.addControl(a.customControls[b])}j.width&&i.css("width",j.width),j.height&&i.css("height",j.height),a.leaflet={},a.leaflet.maxZoom=j.defaults&&a.defaults&&a.defaults.maxZoom?parseInt(a.defaults.maxZoom,10):e.maxZoom,a.leaflet.minZoom=j.defaults&&a.defaults&&a.defaults.minZoom?parseInt(a.defaults.minZoom,10):e.minZoom,a.leaflet.doubleClickZoom=j.defaults&&a.defaults&&"boolean"==typeof a.defaults.doubleClickZoom?a.defaults.doubleClickZoom:e.doubleClickZoom,a.leaflet.scrollWheelZoom=j.defaults&&a.defaults&&"boolean"==typeof a.defaults.scrollWheelZoom?a.defaults.scrollWheelZoom:e.scrollWheelZoom,a.leaflet.attributionControl=j.defaults&&a.defaults&&"boolean"==typeof a.defaults.attributionControl?a.defaults.attributionControl:e.attributionControl;var N=new L.Map(i[0],{maxZoom:a.leaflet.maxZoom,minZoom:a.leaflet.minZoom,doubleClickZoom:a.leaflet.doubleClickZoom,scrollWheelZoom:a.leaflet.scrollWheelZoom,attributionControl:a.leaflet.attributionControl}),O=null;a.leaflet.map=j.testing?N:h,j.leafletmap&&(a.leafletMap=j.leafletmap?N:h),n(),m(),K(),x(),M(),o(),B(),y(),A(),D(),E(),H(),C(),a.$on("leafletDirectiveSetMap",function(a,b){var c=b.shift();N[c].apply(N,b)})}}}]),angular.module("angularLocalStorage",["ngCookies"]).factory("storage",["$parse","$cookieStore","$window","$log",function(a,b,c,d){var e="undefined"==typeof c.localStorage?void 0:c.localStorage,f=!("undefined"==typeof e||"undefined"==typeof c.JSON),g={parseValue:function(a){var b;try{b=c.JSON.parse(a),"undefined"==typeof b&&(b=a),"true"===b&&(b=!0),"false"===b&&(b=!1),c.parseFloat(b)!==b||angular.isObject(b)||(b=c.parseFloat(b))}catch(d){b=a}return b}},h={set:function(a,h){if(!f)try{return b.put(a,h),h}catch(i){d.log("Local Storage not supported, make sure you have angular-cookies enabled.")}var j=c.JSON.stringify(h);return e.setItem(a,j),g.parseValue(j)},get:function(a){if(!f)try{return g.parseValue($.cookie(a))}catch(b){return null}var c=e.getItem(a);return g.parseValue(c)},remove:function(a){if(!f)try{return b.remove(a),!0}catch(c){return!1}return e.removeItem(a),!0},bind:function(b,c,d){var e={defaultValue:"",storeName:""};d=angular.isString(d)?angular.extend({},e,{defaultValue:d}):angular.isUndefined(d)?e:angular.extend(e,d);var f=d.storeName||c;return h.get(f)||h.set(f,d.defaultValue),a(c).assign(b,h.get(f)),b.$watch(c,function(a){angular.isDefined(a)&&h.set(f,a)},!0),h.get(f)},unbind:function(b,c,d){d=d||c,a(c).assign(b,null),b.$watch(c,function(){}),h.remove(d)},clearAll:function(){e.clear()}};return h}]),angular.module("angular-audio-player",["helperFunctions"]).directive("audioPlayer",["$rootScope","$log","$interpolate","$timeout","throttle",function(a,b,c,d,e){var f=function(a,b,c,d){return this instanceof f?(d=d||{},c=c||[],this._element=a,this._audioTag=a[0],this.name=d.name||"audioplayer",this._scope=b,this._bindListeners(b),console.log(c),this._playlist=c,this.playing=!1,this.currentTrack=0,this.tracks=c.length,this.volume=this._audioTag.volume,this.muted=this._audioTag.muted,this.duration=this._audioTag.duration,this.formatDuration="",this.currentTime=this._audioTag.currentTime,this.formatTime="",this.loadPercent=0,this.position=this.currentTime,void 0):new f(a,b,c,d)};return f.prototype={load:function(a,b){if("boolean"==typeof a?(b=a,a=null):"object"==typeof a&&(this._clearAudioList(),this._addAudioList(a)),this._scope.$emit(this.name+":load",b),this._audioTag.load(),b){var c=this;c._element.bind("canplaythrough",function(){c.play(),c._element.unbind("canplaythrough")})}},play:function(a){return this._playlist.length>a?(this.currentTrack=a+1,this.load(this._playlist[a],!0)):(!this.currentTrack&&this._audioTag.readyState&&this.currentTrack++,this._audioTag.play(),void 0)},playPause:function(a){"number"==typeof a&&a+1!==this.currentTrack?this.play(a):this.playing?this.pause():this.play()},pause:function(){this._audioTag.pause()},toggleMute:function(){this.muted=this._audioTag.muted=!this._audioTag.muted},next:function(a){var b=this;if(b.currentTrack&&b.currentTrack<b.tracks){var c=a||b.playing;b.pause(),d(function(){b._clearAudioList(),b._addAudioList(b._playlist[b.currentTrack]),b.load(c),b.currentTrack++})}},prev:function(a){var b=this;if(b.currentTrack&&b.currentTrack-1){var c=a||b.playing;b.pause(),d(function(){b._clearAudioList(),b._addAudioList(b._playlist[b.currentTrack-2]),b.load(c),b.currentTrack--})}},_addAudioList:function(a){var b=this;if(angular.isArray(a))angular.forEach(a,function(a){var d=angular.element(c('<source src="{{ src }}" type="{{ type }}" media="{{ media }}">')(a));b._element.append(d)});else if(angular.isObject(a)){var d=angular.element(c('<source src="{{ src }}" type="{{ type }}" media="{{ media }}">')(a));b._element.append(d)}},_clearAudioList:function(){this._element.contents().remove()},_formatTime:function(a){var b,c=parseInt(a/3600,10)%24,d=parseInt(a/60,10)%60,e=parseInt(a%60,10),f=(10>d?"0"+d:d)+":"+(10>e?"0"+e:e);return b=c>0?(10>c?"0"+c:c)+":"+f:f},_bindListeners:function(a){var b=this,c=this._element,d=e(1e3,!1,function(){a.$apply(function(){b.currentTime=b.position=b._audioTag.currentTime,b.formatTime=b._formatTime(b.currentTime)})}),f=function(c){return function(){a.$apply(function(){b.playing=c}),c?a.$emit(b.name+":play",b.currentTrack-1):a.$emit(b.name+":pause")}},g=function(){a.$apply(function(){b.currentTrack||b.currentTrack++,b.duration=b._audioTag.duration,b.formatDuration=b._formatTime(b.duration),b.loadPercent=parseInt(100*(b._audioTag.buffered.end(b._audioTag.buffered.length-1)/b.duration),10)})},h=function(){b.next(!0)},i=function(){b._audioTag.buffered.length&&a.$apply(function(){b.loadPercent=parseInt(100*(b._audioTag.buffered.end(b._audioTag.buffered.length-1)/b.duration),10)})};c.bind("playing",f(!0)),c.bind("pause",f(!1)),c.bind("ended",h),c.bind("timeupdate",d),c.bind("loadedmetadata",g),c.bind("progress",i)}},{scope:{exposedPlayer:"=playerControl",playlist:"=playlist"},link:function(a,c){if("AUDIO"!==c[0].tagName)return b.error("audioPlayer directive works only when attached to an <audio> type tag");var e=[],g=c.find("source"),h=a.playlist||[];angular.forEach(g,function(a){e.push({src:a.src,type:a.type,media:a.media})}),e.length&&h.unshift(e),a.exposedPlayer=new f(c,a,h),a.$watch("playlist",function(c,e){var f,g=a.exposedPlayer,h=null;if(void 0===c)return void 0!==e?(g.pause(),b.debug("playlist was deleted from scope, pausing and returning")):b.error("if you use playlist attribute, you need to $scope.playlistVariable = []; in your code");if(g.currentTrack){f=e?e[g.currentTrack-1]:-1;for(var i=0;i<c.length;i++)if(angular.equals(c[i],f)){h=i;break}null!==h?(g.currentTrack=h+1,g.tracks=c.length):(g.pause(),c.length&&d(function(){g._clearAudioList(),g._addAudioList(c[0]),g.load(),g.tracks=c.length}))}else c.length&&(g._clearAudioList(),g._addAudioList(c[0]),g.load(),g.tracks=c.length)},!0),a.$on("$destroy",function(){})}}}]),angular.module("helperFunctions",[]).factory("throttle",["$timeout",function(a){return function(b,c,d,e){var f,g=0;"boolean"!=typeof c&&(e=d,d=c,c=void 0);var h=function(){var h=this,i=+new Date-g,j=arguments,k=function(){g=+new Date,d.apply(h,j)},l=function(){f=void 0};e&&!f&&k(),f&&a.cancel(f),void 0===e&&i>b?k():c!==!0&&(f=a(e?l:k,void 0===e?b-i:b))};return h}}]),angular.module("angular-md5",[]).factory("md5",[function(){var a={createHash:function(a){var b,c,d,e,f,g,h,i,j,k,l=function(a,b){return a<<b|a>>>32-b},m=function(a,b){var c,d,e,f,g;return e=2147483648&a,f=2147483648&b,c=1073741824&a,d=1073741824&b,g=(1073741823&a)+(1073741823&b),c&d?2147483648^g^e^f:c|d?1073741824&g?3221225472^g^e^f:1073741824^g^e^f:g^e^f},n=function(a,b,c){return a&b|~a&c},o=function(a,b,c){return a&c|b&~c},p=function(a,b,c){return a^b^c},q=function(a,b,c){return b^(a|~c)},r=function(a,b,c,d,e,f,g){return a=m(a,m(m(n(b,c,d),e),g)),m(l(a,f),b)},s=function(a,b,c,d,e,f,g){return a=m(a,m(m(o(b,c,d),e),g)),m(l(a,f),b)},t=function(a,b,c,d,e,f,g){return a=m(a,m(m(p(b,c,d),e),g)),m(l(a,f),b)},u=function(a,b,c,d,e,f,g){return a=m(a,m(m(q(b,c,d),e),g)),m(l(a,f),b)},v=function(a){for(var b,c=a.length,d=c+8,e=(d-d%64)/64,f=16*(e+1),g=new Array(f-1),h=0,i=0;c>i;)b=(i-i%4)/4,h=8*(i%4),g[b]=g[b]|a.charCodeAt(i)<<h,i++;return b=(i-i%4)/4,h=8*(i%4),g[b]=g[b]|128<<h,g[f-2]=c<<3,g[f-1]=c>>>29,g},w=function(a){var b,c,d="",e="";for(c=0;3>=c;c++)b=255&a>>>8*c,e="0"+b.toString(16),d+=e.substr(e.length-2,2);return d},x=[],y=7,z=12,A=17,B=22,C=5,D=9,E=14,F=20,G=4,H=11,I=16,J=23,K=6,L=10,M=15,N=21;for(x=v(a),h=1732584193,i=4023233417,j=2562383102,k=271733878,b=x.length,c=0;b>c;c+=16)d=h,e=i,f=j,g=k,h=r(h,i,j,k,x[c+0],y,3614090360),k=r(k,h,i,j,x[c+1],z,3905402710),j=r(j,k,h,i,x[c+2],A,606105819),i=r(i,j,k,h,x[c+3],B,3250441966),h=r(h,i,j,k,x[c+4],y,4118548399),k=r(k,h,i,j,x[c+5],z,1200080426),j=r(j,k,h,i,x[c+6],A,2821735955),i=r(i,j,k,h,x[c+7],B,4249261313),h=r(h,i,j,k,x[c+8],y,1770035416),k=r(k,h,i,j,x[c+9],z,2336552879),j=r(j,k,h,i,x[c+10],A,4294925233),i=r(i,j,k,h,x[c+11],B,2304563134),h=r(h,i,j,k,x[c+12],y,1804603682),k=r(k,h,i,j,x[c+13],z,4254626195),j=r(j,k,h,i,x[c+14],A,2792965006),i=r(i,j,k,h,x[c+15],B,1236535329),h=s(h,i,j,k,x[c+1],C,4129170786),k=s(k,h,i,j,x[c+6],D,3225465664),j=s(j,k,h,i,x[c+11],E,643717713),i=s(i,j,k,h,x[c+0],F,3921069994),h=s(h,i,j,k,x[c+5],C,3593408605),k=s(k,h,i,j,x[c+10],D,38016083),j=s(j,k,h,i,x[c+15],E,3634488961),i=s(i,j,k,h,x[c+4],F,3889429448),h=s(h,i,j,k,x[c+9],C,568446438),k=s(k,h,i,j,x[c+14],D,3275163606),j=s(j,k,h,i,x[c+3],E,4107603335),i=s(i,j,k,h,x[c+8],F,1163531501),h=s(h,i,j,k,x[c+13],C,2850285829),k=s(k,h,i,j,x[c+2],D,4243563512),j=s(j,k,h,i,x[c+7],E,1735328473),i=s(i,j,k,h,x[c+12],F,2368359562),h=t(h,i,j,k,x[c+5],G,4294588738),k=t(k,h,i,j,x[c+8],H,2272392833),j=t(j,k,h,i,x[c+11],I,1839030562),i=t(i,j,k,h,x[c+14],J,4259657740),h=t(h,i,j,k,x[c+1],G,2763975236),k=t(k,h,i,j,x[c+4],H,1272893353),j=t(j,k,h,i,x[c+7],I,4139469664),i=t(i,j,k,h,x[c+10],J,3200236656),h=t(h,i,j,k,x[c+13],G,681279174),k=t(k,h,i,j,x[c+0],H,3936430074),j=t(j,k,h,i,x[c+3],I,3572445317),i=t(i,j,k,h,x[c+6],J,76029189),h=t(h,i,j,k,x[c+9],G,3654602809),k=t(k,h,i,j,x[c+12],H,3873151461),j=t(j,k,h,i,x[c+15],I,530742520),i=t(i,j,k,h,x[c+2],J,3299628645),h=u(h,i,j,k,x[c+0],K,4096336452),k=u(k,h,i,j,x[c+7],L,1126891415),j=u(j,k,h,i,x[c+14],M,2878612391),i=u(i,j,k,h,x[c+5],N,4237533241),h=u(h,i,j,k,x[c+12],K,1700485571),k=u(k,h,i,j,x[c+3],L,2399980690),j=u(j,k,h,i,x[c+10],M,4293915773),i=u(i,j,k,h,x[c+1],N,2240044497),h=u(h,i,j,k,x[c+8],K,1873313359),k=u(k,h,i,j,x[c+15],L,4264355552),j=u(j,k,h,i,x[c+6],M,2734768916),i=u(i,j,k,h,x[c+13],N,1309151649),h=u(h,i,j,k,x[c+4],K,4149444226),k=u(k,h,i,j,x[c+11],L,3174756917),j=u(j,k,h,i,x[c+2],M,718787259),i=u(i,j,k,h,x[c+9],N,3951481745),h=m(h,d),i=m(i,e),j=m(j,f),k=m(k,g);
var O=w(h)+w(i)+w(j)+w(k);return O.toLowerCase()}};return a}]).filter("gravatar",["md5",function(a){return function(b){return b?a.createHash(b.toLowerCase()):""}}]);